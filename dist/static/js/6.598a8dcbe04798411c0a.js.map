{"version":3,"sources":["webpack:///src/assets/page/admin/music/addMusic.vue","webpack:///./src/assets/page/admin/music/addMusic.vue?50c7","webpack:///./src/assets/page/admin/music/addMusic.vue"],"names":["addMusic","getSingers","_this","this","list","error","FileReader","file","result","FormData","formData","response","name","lyrice","singerId","uploadMusicUrl","uploadImgUrl","data","then","msg","catch","url","fileList","length","singerList","id","music_addMusic","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","for","_v","directives","rawName","value","expression","type","domProps","on","input","$event","target","composing","popper-class","fetch-suggestions","querySearch","placeholder","select","handleSelect","scopedSlots","_u","key","fn","ref","item","_s","model","callback","$$v","singerName","staticStyle","display","align-items","action","accept","on-preview","handlePreview","on-remove","handleRemove","before-remove","beforeRemove","limit","on-exceed","handleExceed","file-list","on-success","handleSuccess","size","slot","margin-bottom","style","background-image","padding-top","src","__webpack_require__","alt","change","chooseImg","text-align","click","sumbitSong","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/6.598a8dcbe04798411c0a.js","sourcesContent":["\n<template>\n  <div>\n     <div class=\"text-content\">\n        <div class=\"mar-20\">\n          <label for=\"\">歌名：</label>\n          <input type=\"text\" v-model=\"name\" class=\"input-box\">\n        </div>\n        <div class=\"mar-20\">\n          <label for=\"\">歌手：</label>\n          <el-autocomplete\n            popper-class=\"my-autocomplete\"\n            v-model=\"singerName\"\n            :fetch-suggestions=\"querySearch\"\n            placeholder=\"请输入内容\"\n            @select=\"handleSelect\">\n            <template slot-scope=\"{ item }\">\n              <div class=\"name\">{{ item.name }}</div>\n            </template>\n          </el-autocomplete>\n        </div>\n\n        <div style=\"display: flex;align-items: center;\">\n          <label for=\"\" name=\"music\">音乐：</label>\n          <el-upload\n            :action=\"uploadMusicUrl\"\n            accept=\"audio/mp3\"\n            class=\"upload-demo\"\n            :on-preview=\"handlePreview\"\n            :on-remove=\"handleRemove\"\n            :before-remove=\"beforeRemove\"\n            :limit=\"1\"\n            :on-exceed=\"handleExceed\"\n            :file-list=\"fileList\"\n            :on-success=\"handleSuccess\">\n            <el-button size=\"small\" type=\"primary\">点击上传音乐</el-button>\n            <div slot=\"tip\" class=\"el-upload__tip\">只能上传mp3文件</div>\n          </el-upload>\n        </div>\n        <div style=\"margin-bottom: 0;\" class=\"mar-20 bg-img-content\">\n            <label for=\"\">背景：</label>\n            <div class=\"bg-img-box\" :style=\"{'background-image' : 'url('+ uploadImgUrl +')'}\">\n            <img v-show=\"isShowAdd\" style=\"padding-top: 25px;\" src=\"../../../images/add-img1.png\" alt=\"\">\n            <input class=\"upload-input\" type=\"file\" @change=\"chooseImg\">\n            </div>\n        </div>\n        <div class=\"lyric-container\">\n          <label for=\"\">歌词：</label>\n          <textarea type=\"text\" v-model=\"lyrice\" class=\"text-box2\" ></textarea>\n        </div>\n    </div>\n    <div class=\"group-btn\" style=\"text-align: right;\">\n        <button class=\"refresh-btn\" @click=\"sumbitSong\">保存</button>\n    </div> \n  </div>\n</template>\n\n<script>\nimport { _sumbitSong, _getSingers, _uploadMusic } from \"@/api/admin\";\n\nexport default {\n  name: \"addSinger\",\n  data() {\n    return {\n      name: \"\",\n      uploadImgUrl: '',\n      isShowAdd: true,\n      singerList: [],\n      singerName: '',\n      singerId: '',\n      fileList: [],\n      lyrice: '',\n      uploadMusicUrl: ''\n    }\n  },\n  created () {\n    this.uploadMusicUrl = process.env.NODE_ENV == 'development' ? process.env.BASE_API + '/activity/upload_music' : process.env.BASE_API + '/upload_music'\n    this.getSingers()\n  },\n  methods: {\n    // 获取歌手\n    getSingers () {\n      _getSingers().then(response => {\n        if (response.data.code == 200) {\n          this.singerList = response.data.list\n        }\n      }).catch(error => {\n        console.log(error)\n      })\n    },\n    // 选择相片\n    chooseImg (e) {\n      var that = this\n      var file = e.target.files[0]\n       if (!file || !window.FileReader) return\n      if (/^image/.test(file.type)) {\n        // 创建一个reader\n        let reader = new FileReader()\n        // 将图片2将转成 base64 格式\n        reader.readAsDataURL(file)\n        // 读取成功后的回调\n        reader.onloadend = function () {\n          let result = this.result\n          //  判断图片是否大于200K,是就直接上传，反之压缩图片\n          if (this.result.length <= (500 * 1024)) {\n            that.uploadImgUrl = result\n            that.isShowAdd = false\n          } else {\n            alert('图片过大，请上传小于500k的照片')\n          }\n        }\n      }\n    },\n    // 上传音乐\n    uploadMusic: function (file) {\n      var formData=new FormData();\n      formData.append('file',file);\n      var file = formData;\n      _uploadMusic(file).then(response => {\n        console.log(response)\n      }).catch(error => {\n        console.log(error)\n      })\n    },\n    // 提交\n    sumbitSong: function() {\n      var that = this;\n      if (this.singer_name == \"\") {\n        alert(\"请输入名称\");\n        return;\n      } else if (this.uploadMusicUrl == '') {\n        alert('请上传音乐')\n        return;\n      } \n      var data = {\n        name: that.name,\n        lyric: that.lyrice,\n        singer_id: that.singerId,\n        music_url: that.uploadMusicUrl,\n        img_url: that.uploadImgUrl\n      };\n      _sumbitSong(data)\n        .then(response => {\n          if (response.data.code == 200) {\n            alert(\"添加成功\");\n            // that.$router.push(\"/web_admin/music_manage\");\n          } else {\n            alert(response.data.msg);\n          }\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    },\n  \n    handleSuccess (response, file, fileList) {\n      console.log(response)\n      if (response.code == 200) {\n        this.uploadMusicUrl = response.url\n      } else {\n        alert(response.msg)\n      }\n    },\n    handleRemove(file, fileList) {\n      console.log(file, fileList);\n    },\n    handlePreview(file) {\n      console.log(file);\n    },\n    handleExceed(files, fileList) {\n      this.$message.warning(`当前限制选择1个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);\n    },\n    beforeRemove(file, fileList) {\n      return this.$confirm(`确定移除 ${ file.name }？`);\n    },\n\n    querySearch(queryString, cb) {\n      var singerList = this.singerList;\n      var results = queryString ? singerList.filter(this.createFilter(queryString)) : singerList;\n      cb(results);\n    },\n    createFilter(queryString) {\n      return (singer) => {\n        return (singer.name.toLowerCase().indexOf(queryString.toLowerCase()) === 0);\n      };\n    },\n    handleSelect(item) {\n      this.singerName = item.name\n      this.singerId = item.id\n    }\n  }\n};\n</script> \n\n<style>\n.bg-img-content {\n  display: flex;\n  align-items: center;\n}\n.bg-img-box {\n  position: relative;\n  border: 2px dashed #cac9c9;\n  width: 100px;\n  height: 100px;\n  display: inline-block;\n  margin-bottom: 20px;\n  background: #f5f5f5;\n  text-align: center;\n  background-size: cover;\n}\n.bg-img-box .upload-input {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 200px;\n  height: 100px;\n  opacity: 0;\n}\n.lyric-container {\n  display: flex;\n  align-items: center;\n  margin: 20px 0;\n}\n.text-box2 {\n  width: 500px;\n  height: 100px;\n  border: 1px solid #eee\n}\n.my-autocomplete li{\n  line-height: normal;\n  padding: 7px;\n}\n.name {\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.addr {\n  font-size: 12px;\n  color: #b4b4b4;\n}\n.highlighted .addr {\n  color: #ddd;\n}\n.mar-20 {\n  margin: 20px 0;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/assets/page/admin/music/addMusic.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"text-content\"},[_c('div',{staticClass:\"mar-20\"},[_c('label',{attrs:{\"for\":\"\"}},[_vm._v(\"歌名：\")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.name),expression:\"name\"}],staticClass:\"input-box\",attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.name=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"mar-20\"},[_c('label',{attrs:{\"for\":\"\"}},[_vm._v(\"歌手：\")]),_vm._v(\" \"),_c('el-autocomplete',{attrs:{\"popper-class\":\"my-autocomplete\",\"fetch-suggestions\":_vm.querySearch,\"placeholder\":\"请输入内容\"},on:{\"select\":_vm.handleSelect},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(item.name))])]}}]),model:{value:(_vm.singerName),callback:function ($$v) {_vm.singerName=$$v},expression:\"singerName\"}})],1),_vm._v(\" \"),_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\"}},[_c('label',{attrs:{\"for\":\"\",\"name\":\"music\"}},[_vm._v(\"音乐：\")]),_vm._v(\" \"),_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"action\":_vm.uploadMusicUrl,\"accept\":\"audio/mp3\",\"on-preview\":_vm.handlePreview,\"on-remove\":_vm.handleRemove,\"before-remove\":_vm.beforeRemove,\"limit\":1,\"on-exceed\":_vm.handleExceed,\"file-list\":_vm.fileList,\"on-success\":_vm.handleSuccess}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传音乐\")]),_vm._v(\" \"),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"只能上传mp3文件\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"mar-20 bg-img-content\",staticStyle:{\"margin-bottom\":\"0\"}},[_c('label',{attrs:{\"for\":\"\"}},[_vm._v(\"背景：\")]),_vm._v(\" \"),_c('div',{staticClass:\"bg-img-box\",style:({'background-image' : 'url('+ _vm.uploadImgUrl +')'})},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowAdd),expression:\"isShowAdd\"}],staticStyle:{\"padding-top\":\"25px\"},attrs:{\"src\":require(\"../../../images/add-img1.png\"),\"alt\":\"\"}}),_vm._v(\" \"),_c('input',{staticClass:\"upload-input\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.chooseImg}})])]),_vm._v(\" \"),_c('div',{staticClass:\"lyric-container\"},[_c('label',{attrs:{\"for\":\"\"}},[_vm._v(\"歌词：\")]),_vm._v(\" \"),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.lyrice),expression:\"lyrice\"}],staticClass:\"text-box2\",attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.lyrice)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.lyrice=$event.target.value}}})])]),_vm._v(\" \"),_c('div',{staticClass:\"group-btn\",staticStyle:{\"text-align\":\"right\"}},[_c('button',{staticClass:\"refresh-btn\",on:{\"click\":_vm.sumbitSong}},[_vm._v(\"保存\")])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-d163d008\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/assets/page/admin/music/addMusic.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-d163d008\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./addMusic.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./addMusic.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./addMusic.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-d163d008\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./addMusic.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/page/admin/music/addMusic.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}